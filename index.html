<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å€‹äººåŒ–è³‡ç”¢å£“åŠ›æ¸¬è©¦è¡¨ (å«æŒæœ‰æ™‚é–“)</title>
    <style>
        :root {
            --bg-color: #f0f3f5;
            --card-bg: #ffffff;
            --text-main: #2d3436;
            --text-light: #636e72;
            --text-blue: #0984e3;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #d63031;
            --black-swan: #2d3436;
            --primary: #0984e3;
            --border-radius: 12px;
        }
        body { font-family: "Microsoft JhengHei", "Segoe UI", sans-serif; background: var(--bg-color); color: var(--text-main); margin: 0; padding: 20px; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }

        /* --- æ§åˆ¶é¢æ¿ --- */
        .dashboard-panel {
            background: var(--card-bg); padding: 30px; border-radius: var(--border-radius);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05); margin-bottom: 25px; border-top: 5px solid var(--primary);
        }

        .header-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-bottom: 20px; }
        .header-title h2 { margin: 0; color: var(--text-main); }
        .header-title p { margin: 5px 0 0; color: var(--text-light); font-size: 0.9em; }
        
        .market-metrics { text-align: right; }
        .metric-big { font-size: 2em; font-weight: 800; color: var(--danger); font-family: Consolas, monospace; }
        
        /* æ»‘æ¡¿ */
        .slider-wrapper { position: relative; margin: 50px 20px 30px 20px; }
        input[type=range] {
            width: 100%; -webkit-appearance: none; background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 28px; width: 28px; border-radius: 50%;
            background: var(--text-main); border: 4px solid #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.4);
            cursor: pointer; margin-top: -12px; 
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 8px; cursor: pointer; 
            background: linear-gradient(90deg, #55efc4 0%, #fab1a0 50%, #d63031 80%, #2d3436 100%); 
            border-radius: 4px;
        }
        .markers { position: relative; width: 100%; height: 30px; margin-top: 10px; font-size: 11px; color: #999; }
        .marker-item { position: absolute; transform: translateX(-50%); text-align: center; }

        /* æƒ…å¢ƒèªªæ˜æ¡† */
        .scenario-box {
            background: #ecf0f1; border-left: 5px solid var(--primary);
            padding: 15px; margin-top: 20px; border-radius: 4px; font-size: 0.95em; transition: all 0.3s;
        }
        .scenario-box.black-swan { background: #2d3436; color: #fff; border-left-color: #d63031; }

        /* --- å¡ç‰‡è¨­è¨ˆ --- */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        
        .card {
            background: var(--card-bg); border-radius: var(--border-radius); padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03); border: 1px solid #eee;
            position: relative; overflow: hidden; transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.08); }
        .card::before { content: ''; position: absolute; top: 0; left: 0; width: 6px; height: 100%; background: var(--success); }
        .card.warn::before { background: var(--warning); }
        .card.danger::before { background: var(--danger); }

        .card-header { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px dashed #eee; }
        .asset-name { font-weight: bold; font-size: 1.1em; display: block; }
        
        /* æŒæœ‰æ™‚é–“æ¨£å¼ (æ¨¡ä»¿åŸåœ–é¢¨æ ¼) */
        .duration-badge {
            display: inline-block; font-size: 0.8em; color: var(--text-blue);
            background: #e3f2fd; padding: 2px 8px; border-radius: 4px; margin-top: 5px;
        }
        .duration-badge i { margin-right: 4px; }

        .status-tag { float: right; padding: 4px 10px; border-radius: 20px; font-size: 0.75em; font-weight: bold; color: #fff; }
        
        .data-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9em; }
        .num { font-family: Consolas, monospace; font-weight: 600; }
        .val-sim { color: var(--primary); font-weight: bold; }
        
        .bar-container { background: #eee; height: 8px; border-radius: 4px; margin-top: 10px; overflow: hidden; }
        .bar-fill { height: 100%; transition: width 0.4s ease; }
        .bar-info { display: flex; justify-content: space-between; font-size: 0.8em; margin-top: 4px; color: var(--text-light); }

        /* --- Tabs --- */
        .info-section { margin-top: 40px; background: #fff; border-radius: var(--border-radius); box-shadow: 0 4px 20px rgba(0,0,0,0.05); overflow: hidden; }
        .tabs { display: flex; background: #f8f9fa; border-bottom: 1px solid #eee; overflow-x: auto;}
        .tab-btn {
            padding: 15px 25px; cursor: pointer; border: none; background: transparent; 
            font-size: 1em; font-weight: bold; color: var(--text-light); border-bottom: 3px solid transparent; white-space: nowrap;
        }
        .tab-btn.active { color: var(--primary); border-bottom-color: var(--primary); background: #fff; }
        .tab-content { padding: 30px; display: none; }
        .tab-content.active { display: block; }

        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .info-block h3 { border-bottom: 2px solid #eee; padding-bottom: 10px; color: var(--primary); }
        .info-list li { margin-bottom: 10px; }

        @media (max-width: 768px) {
            .info-grid { grid-template-columns: 1fr; }
            .header-row { flex-direction: column; align-items: flex-start; }
            .market-metrics { text-align: left; margin-top: 15px; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="dashboard-panel">
        <div class="header-row">
            <div class="header-title">
                <h2>ğŸ“ˆ å€‹äººæŠ•è³‡ä¿å–®èˆ‡è³ªæŠ¼æ¨¡æ“¬å™¨</h2>
                <p>è³‡æ–™ä¾†æºï¼šæ‚¨æä¾›çš„å°å¸³å–®æ•¸æ“š (2025/11/30 åŸºæº–)</p>
            </div>
            <div class="market-metrics">
                <div class="metric-label">æ¨¡æ“¬å¤§ç›¤è·Œå¹…</div>
                <div id="marketDropDisplay" class="metric-big">0%</div>
            </div>
        </div>

        <div class="slider-wrapper">
            <input type="range" id="crashSlider" min="0" max="70" value="0" step="1" oninput="updateSimulation()">
            <div class="markers">
                <div class="marker-item" style="left: 0%">0%</div>
                <div class="marker-item" style="left: 14%">-10%</div>
                <div class="marker-item" style="left: 28%">-20%</div>
                <div class="marker-item" style="left: 42%">COVID</div>
                <div class="marker-item" style="left: 71%">2008æµ·å˜¯</div>
                <div class="marker-item" style="left: 95%; color:var(--danger); font-weight:bold;">2000ç¶²è·¯æ³¡æ²«</div>
            </div>
        </div>

        <div id="scenarioBox" class="scenario-box">
            <strong id="scenarioTitle">ğŸŸ¢ ç›®å‰ç‹€æ…‹ï¼šæŒæœ‰ä¸­</strong><br>
            <span id="scenarioDesc">å¸‚å ´å¹³ç©©ï¼Œä¾ç…§æ‚¨çš„æŒæœ‰æ™‚é–“ï¼Œç›®å‰è³‡ç”¢ç©©å®šå¢å€¼æˆ–é ˜æ¯ä¸­ã€‚</span>
        </div>
    </div>

    <div class="grid" id="cardGrid"></div>

    <div class="info-section">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('tab1')">ğŸ›¡ï¸ å®‰å…¨æ€§åˆ†æ</button>
            <button class="tab-btn" onclick="switchTab('tab2')">ğŸ“– æŒ‡æ¨™èªªæ˜</button>
            <button class="tab-btn" onclick="switchTab('tab3')">ğŸš¨ æ‡‰è®Š SOP</button>
        </div>

        <div id="tab1" class="tab-content active">
            <div class="info-grid">
                <div class="info-block">
                    <h3>æ‚¨çš„é…ç½® vs æ­·å²è‚¡ç½</h3>
                    <p>æ­¤æ¨¡æ“¬å™¨å·²æ ¹æ“šæ‚¨æŒæœ‰çš„ã€Œå¹³è¡¡å‹åŸºé‡‘ã€èˆ‡ã€Œ5:4:1 ETF çµ„åˆã€è¨­å®šæŠ—è·Œä¿‚æ•¸ï¼š</p>
                    <ul class="info-list">
                        <li><strong>æ¥µåº¦æŠ—è·Œï¼š</strong> å³ä½¿æ¨¡æ“¬ 2000 å¹´ (-67%) çš„æ¯€æ»…æ€§è‚¡ç½ï¼Œæ‚¨çš„ ETF çµ„åˆå› å«æœ‰ 40% å‚µåˆ¸ï¼Œé ä¼°åƒ…ä¿®æ­£ç´„ 37%ã€‚</li>
                        <li><strong>æ™‚é–“å„ªå‹¢ï¼š</strong> å¡ç‰‡ä¸Šé¡¯ç¤ºçš„ã€ŒæŒæœ‰æ™‚é–“ã€æ˜¯æ‚¨çš„æœ‹å‹ã€‚æŒæœ‰è¶Šä¹…ï¼Œç´¯ç©çš„é…æ¯èˆ‡æ·¨å€¼å¢é•·æœƒè®“å®‰å…¨é‚Šéš›æ›´åšã€‚ä¾‹å¦‚ã€Œä¿å–® Aã€å·²æŒæœ‰ 1 å¹´ 2 å€‹æœˆï¼Œé€™æœŸé–“ç´¯ç©çš„æ”¶ç›Šéƒ½æ˜¯é¡å¤–çš„ç·©è¡ã€‚</li>
                    </ul>
                </div>
                <div class="info-block">
                    <h3>é‡é»çµè«–</h3>
                    <ul class="info-list">
                        <li><span style="color:var(--success)">âœ… ä¿å–®å®‰å…¨</span>ï¼šAã€Bã€C ä¿å–®å€Ÿæ¬¾æ¯”æ§åˆ¶åœ¨ 47% ä»¥ä¸‹ï¼Œå³ä½¿è…°æ–¬ä¹Ÿä¸æœƒæ–·é ­ã€‚</li>
                        <li><span style="color:var(--success)">âœ… ETF å®‰å…¨</span>ï¼šè³ªæŠ¼ç¶­æŒç‡æ¥µé«˜ (ç´„ 500%)ï¼ŒåŸºæœ¬ä¸Šç„¡é¢¨éšªã€‚</li>
                        <li><span style="color:var(--primary)">ğŸ’¡ ä¿å–® E ç­–ç•¥</span>ï¼šæ¨™ç¤ºç‚ºã€Œæœªè¨­å®šã€çš„å„²è“„éšªï¼Œè«‹ä¿æŒå…¶æµå‹•æ€§ï¼Œå®ƒæ˜¯æ‚¨æœ€å¾Œçš„ç¾é‡‘æ°´åº«ã€‚</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="tab2" class="tab-content">
            <div class="info-grid">
                <div class="info-block">
                    <h3>ä¿å–®å€Ÿæ¬¾ (LTV)</h3>
                    <p><strong>å…¬å¼ï¼š</strong> å€Ÿæ¬¾ Ã· ç¾å€¼ Ã— 100%</p>
                    <ul class="info-list">
                        <li><span style="color:var(--success)">ğŸŸ¢ å®‰å…¨ (< 80%)</span></li>
                        <li><span style="color:var(--warning)">ğŸŸ¡ è£œç¹³ (80% ~ 90%)</span></li>
                        <li><span style="color:var(--danger)">ğŸ”´ æ–·é ­ (> 90%)</span></li>
                    </ul>
                </div>
                <div class="info-block">
                    <h3>ETF è³ªæŠ¼ (ç¶­æŒç‡)</h3>
                    <p><strong>å…¬å¼ï¼š</strong> å¸‚å€¼ Ã· å€Ÿæ¬¾ Ã— 100%</p>
                    <ul class="info-list">
                        <li><span style="color:var(--success)">ğŸŸ¢ å®‰å…¨ (> 130%)</span></li>
                        <li><span style="color:var(--warning)">ğŸŸ¡ è¿½ç¹³ (< 130%)</span></li>
                        <li><span style="color:var(--danger)">ğŸ”´ æ–·é ­ (< 115%)</span></li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="tab3" class="tab-content">
            <div class="info-block">
                <h3>ğŸš¦ ç·Šæ€¥æ‡‰è®Š SOP</h3>
                <ol>
                    <li><strong>è§€å¯Ÿé»ƒç‡ˆï¼š</strong> è‹¥æ»‘å‹•æ¨¡æ“¬è‡³ -50% æ™‚ç™¼ç¾æŸå¼µä¿å–®è®Šé»ƒï¼Œè«‹å„ªå…ˆæª¢è¦–è©²ä¿å–®ã€‚</li>
                    <li><strong>å‹•ç”¨ä¿å–® Eï¼š</strong> é€™å¼µç´”å„²è“„éšªä¸å—è‚¡å¸‚å½±éŸ¿ã€‚è‹¥å…¶ä»–ä¿å–®éœ€è£œç¹³ï¼Œè«‹è³ªæŠ¼ä¿å–® E å–å‡ºè³‡é‡‘ã€‚</li>
                    <li><strong>åœæ­¢å†æŠ•è³‡ï¼š</strong> è‚¡ç½æœŸé–“ï¼Œå°‡ ETF é…æ¯ç•™åœ¨å¸³ä¸Šï¼Œä¸è¦æŠ•å…¥è‚¡å¸‚ï¼Œä»¥æé«˜ç¾é‡‘æ°´ä½ã€‚</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<script>
    function switchTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // è³‡ç”¢è³‡æ–™ (å·²åŠ å…¥æ‚¨çš„æŒæœ‰æ™‚é–“)
    const assets = [
        { id: 'A', name: 'ä¿å–® A (æ³•å·´å¹´é‡‘)', type: 1, val: 47.7, loan: 21.5, limit1: 80, limit2: 90, duration: '1å¹´ 2å€‹æœˆ' },
        { id: 'B', name: 'ä¿å–® B (æ³•å·´å£½éšª)', type: 1, val: 147.8, loan: 68.5, limit1: 80, limit2: 90, duration: '1å¹´ 1å€‹æœˆ' },
        { id: 'C', name: 'ä¿å–® C (å®‰é”å¹´é‡‘)', type: 1, val: 180, loan: 84, limit1: 80, limit2: 90, duration: '2å€‹æœˆ' },
        { id: 'D', name: 'ä¿å–® D (å®‰è¯ä¸»åŠ›)', type: 1, val: 328, loan: 90, limit1: 80, limit2: 90, duration: '4å€‹æœˆ' },
        { id: 'E', name: 'ä¿å–® E (é é›„äººå£½)', type: 2, val: 15, loan: 8, limit1: 95, limit2: 100, duration: 'æœªè¨­å®š (å„²è“„å‹)' },
        { id: 'ETF', name: 'å°è‚¡ ETF çµ„åˆ (è³ªæŠ¼)', type: 3, val: 171, loan: 34.5, limit1: 130, limit2: 115, duration: 'æœªè¨­å®š' }
    ];

    function updateSimulation() {
        const sliderVal = document.getElementById('crashSlider').value;
        const marketDropPct = parseInt(sliderVal);
        
        document.getElementById('marketDropDisplay').innerText = `-${marketDropPct}%`;

        const titleEl = document.getElementById('scenarioTitle');
        const descEl = document.getElementById('scenarioDesc');
        const boxEl = document.getElementById('scenarioBox');
        
        titleEl.style.color = "";
        boxEl.className = "scenario-box";

        if(marketDropPct < 10) {
            titleEl.innerHTML = "ğŸŸ¢ å¸‚å ´ç‹€æ³ï¼šå¹³ç©© / ä¿®æ­£";
            descEl.innerHTML = "è³‡ç”¢æ³¢å‹•åœ¨æ­£å¸¸ç¯„åœï¼Œæ‚¨çš„é•·æœŸæŒæœ‰ç­–ç•¥æŒçºŒç™¼é…µä¸­ã€‚";
            titleEl.style.color = "var(--success)";
        } else if(marketDropPct < 30) {
            titleEl.innerHTML = "ğŸŸ¡ å¸‚å ´ç‹€æ³ï¼šç†Šå¸‚ (-20% ~ -30%)";
            descEl.innerHTML = "é¡ä¼¼ 2022 å¹´è‚¡å‚µé›™æ®ºã€‚è³‡ç”¢ç¸®æ°´ï¼Œä½†è·é›¢è­¦æˆ’ç·šä»éå¸¸é™é ã€‚";
            titleEl.style.color = "#e67e22";
        } else if(marketDropPct < 60) {
            titleEl.innerHTML = "ğŸŸ  å¸‚å ´ç‹€æ³ï¼šé‡‘èæµ·å˜¯ (-50%)";
            descEl.innerHTML = "é¡ä¼¼ 2008 å¹´ã€‚é€™æ˜¯å¤§å¤šæ•¸å£“åŠ›çš„æ¥µé™ï¼Œè«‹æª¢æŸ¥ä¸‹æ–¹ç‡ˆè™Ÿã€‚";
            titleEl.style.color = "var(--danger)";
        } else {
            titleEl.innerHTML = "âš« å¸‚å ´ç‹€æ³ï¼š2000 ç¶²è·¯æ³¡æ²« (-67%)";
            descEl.innerHTML = "å°è‚¡æ­·å²æœ€å¤§è·Œå¹…ã€‚é€™æ˜¯çµ‚æ¥µå£“åŠ›æ¸¬è©¦ï¼Œæª¢è¦–è³‡ç”¢æ˜¯å¦æ­¸é›¶ã€‚";
            boxEl.className = "scenario-box black-swan"; 
        }

        const grid = document.getElementById('cardGrid');
        grid.innerHTML = '';

        assets.forEach(item => {
            // Beta è¨­å®šï¼šå¹³è¡¡å‹ 0.6, ETF 0.55
            let beta = (item.type === 1) ? 0.6 : (item.type === 3) ? 0.55 : 0;
            const itemDropPct = marketDropPct * beta;
            const currentVal = item.val * (1 - (itemDropPct / 100));

            let riskVal = 0; 
            let status = 'safe';
            let statusText = 'å®‰å…¨';
            let barColor = 'var(--success)';
            let barWidth = 0;
            let displayRisk = '';

            if (item.type === 1 || item.type === 2) {
                // ä¿å–® (LTV)
                riskVal = (item.loan / currentVal) * 100;
                displayRisk = `å€Ÿæ¬¾æ¯” ${riskVal.toFixed(1)}%`;
                
                if (riskVal >= item.limit2) {
                    status = 'danger'; statusText = 'æ–·é ­'; barColor = 'var(--danger)';
                } else if (riskVal >= item.limit1) {
                    status = 'warn'; statusText = 'éœ€è£œç¹³'; barColor = 'var(--warning)';
                }
                barWidth = Math.min(riskVal, 100);
            } else {
                // ETF (ç¶­æŒç‡)
                riskVal = (currentVal / item.loan) * 100;
                displayRisk = `ç¶­æŒç‡ ${riskVal.toFixed(0)}%`;
                
                if (riskVal <= item.limit2) {
                    status = 'danger'; statusText = 'æ–·é ­'; barColor = 'var(--danger)';
                } else if (riskVal <= item.limit1) {
                    status = 'warn'; statusText = 'è¿½ç¹³'; barColor = 'var(--warning)';
                }
                barWidth = Math.min((riskVal / 300) * 100, 100); 
            }

            const html = `
            <div class="card ${status}">
                <div class="card-header">
                    <span class="status-tag" style="background:${barColor}">${statusText}</span>
                    <span class="asset-name">${item.name}</span>
                    <span class="duration-badge">
                        <span>ğŸ•’ æŒæœ‰: ${item.duration}</span>
                    </span>
                </div>
                <div class="data-row">
                    <span>åŸå§‹ç¾å€¼</span>
                    <span class="num">${item.val} è¬</span>
                </div>
                <div class="data-row">
                    <span>æ¨¡æ“¬ç¾å€¼ (-${itemDropPct.toFixed(1)}%)</span>
                    <span class="num val-sim">${currentVal.toFixed(1)} è¬</span>
                </div>
                <div class="data-row">
                    <span>å€Ÿæ¬¾é‡‘é¡</span>
                    <span class="num">${item.loan} è¬</span>
                </div>
                
                <div class="bar-container">
                    <div class="bar-fill" style="width: ${barWidth}%; background: ${barColor};"></div>
                </div>
                <div class="bar-info">
                    <span>${displayRisk}</span>
                    <span>${item.type === 3 ? 'ç¶­æŒç‡ > 130% å®‰å…¨' : 'å€Ÿæ¬¾æ¯” < 80% å®‰å…¨'}</span>
                </div>
            </div>
            `;
            grid.innerHTML += html;
        });
    }

    updateSimulation();
</script>

</body>
</html>
