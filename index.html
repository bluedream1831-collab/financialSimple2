<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ•è³‡ä¿å–®èˆ‡ ETF è³ªæŠ¼ - æ·±åº¦å£“åŠ›æ¸¬è©¦å ±å‘Š</title>
    <style>
        :root {
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-light: #607d8b;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #c0392b;
            --primary: #2980b9;
            --border-radius: 12px;
        }
        body { font-family: "Microsoft JhengHei", "Segoe UI", sans-serif; background: var(--bg-color); color: var(--text-main); margin: 0; padding: 20px; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }

        /* --- ä¸ŠåŠéƒ¨ï¼šæ§åˆ¶èˆ‡å„€è¡¨æ¿ --- */
        .dashboard-panel {
            background: var(--card-bg); padding: 30px; border-radius: var(--border-radius);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05); margin-bottom: 25px;
        }

        .header-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-bottom: 20px; }
        .header-title h2 { margin: 0; color: var(--text-main); }
        .header-title p { margin: 5px 0 0; color: var(--text-light); font-size: 0.9em; }
        
        .market-metrics { text-align: right; }
        .metric-big { font-size: 2em; font-weight: 800; color: var(--danger); font-family: Consolas, monospace; }
        .metric-label { font-size: 0.85em; color: var(--text-light); }

        /* æ»‘æ¡¿æ¨£å¼ */
        .slider-wrapper { position: relative; margin: 40px 20px 20px 20px; }
        input[type=range] {
            width: 100%; -webkit-appearance: none; background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 28px; width: 28px; border-radius: 50%;
            background: var(--text-main); border: 4px solid #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.4);
            cursor: pointer; margin-top: -12px; 
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 8px; cursor: pointer; background: linear-gradient(90deg, #a8e6cf 0%, #ff8b94 100%); border-radius: 4px;
        }
        .markers { display: flex; justify-content: space-between; font-size: 12px; color: #999; margin-top: 10px; padding: 0 5px; }
        
        /* å‹•æ…‹èªªæ˜æ–‡å­—æ¡† */
        .scenario-box {
            background: #ecf0f1; border-left: 5px solid var(--primary);
            padding: 15px; margin-top: 20px; border-radius: 4px; font-size: 0.95em;
        }

        /* --- å¡ç‰‡ç¶²æ ¼ --- */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        
        .card {
            background: var(--card-bg); border-radius: var(--border-radius); padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03); border: 1px solid #eee;
            position: relative; overflow: hidden; transition: all 0.3s;
        }
        .card::before { content: ''; position: absolute; top: 0; left: 0; width: 6px; height: 100%; background: var(--success); }
        .card.warn::before { background: var(--warning); }
        .card.danger::before { background: var(--danger); }

        .card-top { display: flex; justify-content: space-between; margin-bottom: 15px; }
        .asset-name { font-weight: bold; font-size: 1.1em; }
        .tag { padding: 4px 10px; border-radius: 20px; font-size: 0.75em; font-weight: bold; color: #fff; }
        
        .data-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9em; }
        .num { font-family: Consolas, monospace; font-weight: 600; }
        .val-sim { color: var(--primary); }
        
        /* å„€è¡¨æ¢ */
        .bar-container { background: #eee; height: 8px; border-radius: 4px; margin-top: 10px; overflow: hidden; }
        .bar-fill { height: 100%; transition: width 0.4s ease; }
        .bar-info { display: flex; justify-content: space-between; font-size: 0.8em; margin-top: 4px; color: var(--text-light); }

        /* --- ä¸‹åŠéƒ¨ï¼šè©³ç´°èªªæ˜å€ (Tabs) --- */
        .info-section { margin-top: 40px; background: #fff; border-radius: var(--border-radius); box-shadow: 0 4px 20px rgba(0,0,0,0.05); overflow: hidden; }
        .tabs { display: flex; background: #f8f9fa; border-bottom: 1px solid #eee; }
        .tab-btn {
            padding: 15px 25px; cursor: pointer; border: none; background: transparent; 
            font-size: 1em; font-weight: bold; color: var(--text-light); border-bottom: 3px solid transparent;
        }
        .tab-btn:hover { background: #e9ecef; }
        .tab-btn.active { color: var(--primary); border-bottom-color: var(--primary); background: #fff; }
        
        .tab-content { padding: 30px; display: none; }
        .tab-content.active { display: block; }

        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .info-block h3 { border-bottom: 2px solid #eee; padding-bottom: 10px; color: var(--primary); }
        .info-list li { margin-bottom: 10px; }
        .highlight { background: #fff3cd; padding: 2px 5px; border-radius: 3px; }

        @media (max-width: 768px) {
            .info-grid { grid-template-columns: 1fr; }
            .header-row { flex-direction: column; align-items: flex-start; }
            .market-metrics { text-align: left; margin-top: 15px; }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- æ§åˆ¶é¢æ¿ -->
    <div class="dashboard-panel">
        <div class="header-row">
            <div class="header-title">
                <h2>ğŸ“Š è³‡ç”¢å£“åŠ›æ¸¬è©¦æ¨¡æ“¬å™¨</h2>
                <p>é…ç½®åŸºç¤ï¼šå¹³è¡¡å‹åŸºé‡‘ä¿å–® + é«˜è‚¡æ¯/å‚µåˆ¸ ETF çµ„åˆ</p>
            </div>
            <div class="market-metrics">
                <div class="metric-label">ç•¶å‰è¨­å®šï¼šå¤§ç›¤è·Œå¹…</div>
                <div id="marketDropDisplay" class="metric-big">0%</div>
            </div>
        </div>

        <div class="slider-wrapper">
            <input type="range" id="crashSlider" min="0" max="60" value="0" step="1" oninput="updateSimulation()">
            <div class="markers">
                <span>0%<br>å¹³ç›¤</span>
                <span>-10%<br>ä¿®æ­£</span>
                <span>-20%<br>ç†Šå¸‚</span>
                <span>-30%<br>ç–«æƒ…</span>
                <span>-50%<br>é‡‘èæµ·å˜¯</span>
                <span>-60%<br>æ¯€æ»…</span>
            </div>
        </div>

        <div class="scenario-box">
            <strong id="scenarioTitle">ğŸŸ¢ å¸‚å ´ç‹€æ³ï¼šé¢¨å¹³æµªéœ</strong><br>
            <span id="scenarioDesc">ç›®å‰è‚¡å¸‚æ³¢å‹•åœ¨æ­£å¸¸ç¯„åœå…§ï¼Œæ‚¨çš„è³‡ç”¢åƒ¹å€¼ç©©å®šï¼Œç„¡ä»»ä½•è¿½ç¹³é¢¨éšªã€‚</span>
        </div>
    </div>

    <!-- å¡ç‰‡é¡¯ç¤ºå€ -->
    <div class="grid" id="cardGrid"></div>

    <!-- è©³ç´°èªªæ˜å€ -->
    <div class="info-section">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('tab1')">ğŸ“– æŒ‡æ¨™å®šç¾©èˆ‡é–€æª»</button>
            <button class="tab-btn" onclick="switchTab('tab2')">ğŸ›¡ï¸ ä½ çš„é…ç½®å®‰å…¨æ€§åˆ†æ</button>
            <button class="tab-btn" onclick="switchTab('tab3')">ğŸš¨ é¢¨éšªæ‡‰å° SOP</button>
        </div>

        <!-- Tab 1: æŒ‡æ¨™å®šç¾© -->
        <div id="tab1" class="tab-content active">
            <div class="info-grid">
                <div class="info-block">
                    <h3>ä¿å–®å€Ÿæ¬¾ (LTV)</h3>
                    <p><strong>å…¬å¼ï¼š</strong> å€Ÿæ¬¾é‡‘é¡ Ã· ä¿å–®ç¾å€¼ Ã— 100%</p>
                    <ul class="info-list">
                        <li><span style="color:var(--success)">ğŸŸ¢ å®‰å…¨å€ (< 80%)</span>ï¼šç„¡éœ€ä»»ä½•å‹•ä½œï¼Œæœ¬é‡‘å®‰å…¨ã€‚</li>
                        <li><span style="color:var(--warning)">ğŸŸ¡ è£œç¹³å€ (80% ~ 90%)</span>ï¼šéŠ€è¡Œæœƒé€šçŸ¥ä½ è£œéŒ¢ï¼Œæˆ–å„Ÿé‚„éƒ¨åˆ†æœ¬é‡‘ï¼Œå¦å‰‡ä¿å–®å¯èƒ½å¤±æ•ˆã€‚</li>
                        <li><span style="color:var(--danger)">ğŸ”´ æ–·é ­å€ (> 90%)</span>ï¼šä¿éšªå…¬å¸å¼·åˆ¶è§£ç´„ä»¥å„Ÿé‚„å€Ÿæ¬¾ï¼Œæå¤±æœƒå¯¦ç¾ã€‚</li>
                    </ul>
                </div>
                <div class="info-block">
                    <h3>è‚¡ç¥¨è³ªæŠ¼ (ç¶­æŒç‡)</h3>
                    <p><strong>å…¬å¼ï¼š</strong> è‚¡ç¥¨å¸‚å€¼ Ã· å€Ÿæ¬¾é‡‘é¡ Ã— 100%</p>
                    <ul class="info-list">
                        <li><span style="color:var(--success)">ğŸŸ¢ å®‰å…¨å€ (> 166%)</span>ï¼šä¸€èˆ¬åˆ¸å•†åˆå§‹æ”¾æ¬¾æ¨™æº–ï¼Œéå¸¸å®‰å…¨ã€‚</li>
                        <li><span style="color:var(--success)">ğŸŸ¢ æ³¨æ„å€ (130% ~ 166%)</span>ï¼šé›–ç„¶é‚„æ˜¯ç¶ ç‡ˆï¼Œä½†éœ€é–‹å§‹é—œæ³¨å¸‚å ´ã€‚</li>
                        <li><span style="color:var(--warning)">ğŸŸ¡ è¿½ç¹³å€ (< 130%)</span>ï¼šå¿…é ˆåœ¨å…©å¤©å…§è£œéŒ¢ï¼Œå°‡ç¶­æŒç‡æ‹‰å› 166% ä»¥ä¸Šï¼Œå¦å‰‡æ–·é ­ã€‚</li>
                        <li><span style="color:var(--danger)">ğŸ”´ æ–·é ­å€ (< 115%)</span>ï¼šåˆ¸å•†æœƒç›´æ¥åœ¨é–‹ç›¤æ™‚å°‡ä½ çš„è‚¡ç¥¨å¸‚åƒ¹è³£å‡ºã€‚</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Tab 2: é…ç½®åˆ†æ -->
        <div id="tab2" class="tab-content">
            <div class="info-grid">
                <div class="info-block">
                    <h3>ç‚ºä»€éº¼ä½ çš„è³‡ç”¢è·Œå¾—æ¯”å¤§ç›¤å°‘ï¼Ÿ</h3>
                    <p>æœ¬æ¨¡æ“¬å™¨ä¸¦éå‡è¨­ä½ çš„è³‡ç”¢è·Ÿè‘—å¤§ç›¤ 1:1 ä¸‹è·Œï¼Œè€Œæ˜¯æ ¹æ“šä½ çš„é…ç½®å±¬æ€§è¨­å®šäº†<strong>Beta å€¼ï¼ˆæ³¢å‹•ä¿‚æ•¸ï¼‰</strong>ï¼š</p>
                    <ul class="info-list">
                        <li><strong>å¹³è¡¡å‹ä¿å–® (Beta 0.6)ï¼š</strong> 
                            å› ç‚ºé€™é¡ä¿å–®é€šå¸¸æŒæœ‰ 40%~50% çš„å‚µåˆ¸ã€‚æ­·å²ç¶“é©—é¡¯ç¤ºï¼Œç•¶è‚¡å¸‚è·Œ 10%ï¼Œå¹³è¡¡å‹åŸºé‡‘é€šå¸¸åªè·Œ 6%ã€‚å‚µåˆ¸éƒ¨ä½åœ¨è‚¡ç½æ™‚æä¾›äº†ç·©è¡ã€‚
                        </li>
                        <li><strong>ETF çµ„åˆ (Beta 0.55)ï¼š</strong> 
                            ä½ çš„é…ç½®æ˜¯ <span class="highlight">50% é«˜è‚¡æ¯ + 40% æŠ•ç­‰å‚µ + 10% å¸‚å€¼</span>ã€‚
                            <ul>
                                <li><strong>é«˜è‚¡æ¯ï¼š</strong> é€šå¸¸æ¯”å¤§ç›¤æŠ—è·Œã€‚</li>
                                <li><strong>æŠ•è³‡ç­‰ç´šå‚µï¼š</strong> èˆ‡è‚¡å¸‚ç›¸é—œæ€§ä½ï¼Œç”šè‡³åœ¨å‚³çµ±è‚¡ç½ï¼ˆå¦‚ 2008ï¼‰æœƒä¸Šæ¼²ã€‚</li>
                            </ul>
                            é€™ä½¿å¾—ä½ çš„ ETF çµ„åˆå°±åƒè£äº†é¿éœ‡å™¨ï¼Œå¤§ç›¤è…°æ–¬æ™‚ï¼Œä½ çš„çµ„åˆé ä¼°åƒ…ä¿®æ­£ç´„ 27%~30%ã€‚
                        </li>
                    </ul>
                </div>
                <div class="info-block">
                    <h3>å£“åŠ›æ¸¬è©¦çµè«–</h3>
                    <p>æ ¹æ“šä¸Šæ–¹æ¨¡æ“¬å™¨çš„é‹ç®—çµæœï¼š</p>
                    <ul class="info-list">
                        <li><strong>æ§“æ¡¿å®‰å…¨æ€§ï¼š</strong> ä½ çš„ ETF è³ªæŠ¼å€Ÿæ¬¾æ¯”åƒ…ç´„ 20% (ç¶­æŒç‡è¿‘ 500%)ï¼Œé€™æ˜¯<strong>æ¥µåº¦ä¿å®ˆ</strong>çš„è¨­å®šã€‚å³ä½¿ç™¼ç”Ÿä¸–ç•Œæœ«æ—¥ç´šè‚¡ç½ï¼Œé€™éƒ¨åˆ†å¹¾ä¹ä¸å¯èƒ½è¢«æ–·é ­ã€‚</li>
                        <li><strong>ä¿å–®å®‰å…¨æ€§ï¼š</strong> ä¿å–® Aã€Bã€C ç›®å‰å€Ÿæ¬¾æ¯”ç´„ 45%~47%ã€‚å³ä½¿æ·¨å€¼ä¸‹è·Œ 30% (ç–«æƒ…ç­‰ç´š)ï¼Œå€Ÿæ¬¾æ¯”ä¹Ÿåªæœƒä¸Šå‡åˆ° 65% å·¦å³ï¼Œè·é›¢ 80% çš„è­¦æˆ’ç·šä»æœ‰å·¨å¤§ç©ºé–“ã€‚</li>
                        <li><strong>å”¯ä¸€é¢¨éšªï¼š</strong> åŒ¯ç‡é¢¨éšªã€‚è‹¥ç¾å…ƒä¿å–®è¨ˆåƒ¹ï¼Œä¸”å°å¹£å¤§å¹…å‡å€¼ï¼Œæœƒå°è‡´ä¿å–®æ›ç®—å°å¹£åƒ¹å€¼ç¸®æ°´ã€‚ä½†å³ä¾¿å¦‚æ­¤ï¼Œä½ çš„å®‰å…¨é‚Šéš›ä¾ç„¶è¶³å¤ ã€‚</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Tab 3: SOP -->
        <div id="tab3" class="tab-content">
            <div class="info-block">
                <h3>ğŸš¦ é»ƒç‡ˆ/ç´…ç‡ˆ æ‡‰æ€¥ SOP</h3>
                <p>é›–ç„¶ç™¼ç”Ÿæ©Ÿç‡æ¥µä½ï¼Œä½†è‹¥æ¨¡æ“¬å™¨é¡¯ç¤ºé€²å…¥é»ƒè‰²å€åŸŸï¼Œè«‹ä¾åºåŸ·è¡Œï¼š</p>
                <ol>
                    <li><strong>å‹•ç”¨ã€Œä¿å–® E (é é›„äººå£½)ã€ï¼š</strong> 
                        é€™æ˜¯ä¸€å¼µå„²è“„éšªï¼Œä¸”ç„¡å€Ÿæ¬¾é¢¨éšªã€‚å®ƒæ˜¯ä½ çš„<strong>ç¾é‡‘æ°´åº«</strong>ã€‚è‹¥å…¶ä»–ä¿å–®éœ€è£œç¹³ï¼Œå¯å„ªå…ˆè³ªæŠ¼é€™å¼µä¿å–®å–å‡ºè³‡é‡‘æ•‘ç«ã€‚
                    </li>
                    <li><strong>æš«åœ ETF é…æ¯å†æŠ•å…¥ï¼š</strong> 
                        å°‡ ETF ç”¢ç”Ÿçš„ç¾é‡‘è‚¡æ¯ç•™åœ¨å¸³æˆ¶ä¸­ï¼Œä¸è¦è²·å…¥æ–°è‚¡ï¼Œä»¥æé«˜ç¶­æŒç‡ã€‚
                    </li>
                    <li><strong>å€Ÿæ–°é‚„èˆŠ (ä¸å»ºè­°ä½†å¯è¡Œ)ï¼š</strong> 
                        è‹¥ä¿å–® D é‚„æœ‰é¡åº¦ï¼Œå¯å€Ÿå‡ºè³‡é‡‘å»å„Ÿé‚„å¿«è§¸åŠé–€æª»çš„ä¿å–® A æˆ– B çš„éƒ¨åˆ†æœ¬é‡‘ (é™ä½åˆ†å­)ã€‚
                    </li>
                </ol>
                <p style="margin-top:20px; font-size:0.9em; color:#666;">
                    *å‚™è¨»ï¼šæŠ•è³‡ç­‰ç´šå‚µåˆ¸åœ¨å‡æ¯æœ«æœŸé€šå¸¸æœƒåå½ˆï¼Œé€™å°ä½ çš„ 40% å‚µåˆ¸éƒ¨ä½æ˜¯åˆ©å¤šã€‚åªè¦ä¸ç™¼ç”Ÿã€Œæƒ¡æ€§é€šè†¨å°è‡´çš„è‚¡å‚µé›™æ®ºã€ï¼Œæ­¤é…ç½®å …è‹¥ç£çŸ³ã€‚
                </p>
            </div>
        </div>

    </div>
</div>

<script>
    // Tab åˆ‡æ›åŠŸèƒ½
    function switchTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // è³‡ç”¢è³‡æ–™
    const assets = [
        { id: 'A', name: 'ä¿å–® A (æ³•å·´å¹´é‡‘)', type: 1, val: 47.7, loan: 21.5, limit1: 80, limit2: 90 },
        { id: 'B', name: 'ä¿å–® B (æ³•å·´å£½éšª)', type: 1, val: 147.8, loan: 68.5, limit1: 80, limit2: 90 },
        { id: 'C', name: 'ä¿å–® C (å®‰é”å¹´é‡‘)', type: 1, val: 180, loan: 84, limit1: 80, limit2: 90 },
        { id: 'D', name: 'ä¿å–® D (å®‰è¯ä¸»åŠ›)', type: 1, val: 328, loan: 90, limit1: 80, limit2: 90 }, // å‡è¨­æ¢ä»¶ä¸€è‡´
        { id: 'E', name: 'ä¿å–® E (é é›„äººå£½)', type: 2, val: 15, loan: 8, limit1: 95, limit2: 100 },
        { id: 'ETF', name: 'å°è‚¡ ETF çµ„åˆ (è³ªæŠ¼)', type: 3, val: 171, loan: 34.5, limit1: 130, limit2: 115 }
    ];

    function updateSimulation() {
        const sliderVal = document.getElementById('crashSlider').value;
        const marketDropPct = parseInt(sliderVal);
        
        // æ›´æ–°ä¸Šæ–¹æ•¸å­—
        document.getElementById('marketDropDisplay').innerText = `-${marketDropPct}%`;

        // æ›´æ–°æƒ…å¢ƒèªªæ˜æ–‡å­—
        const titleEl = document.getElementById('scenarioTitle');
        const descEl = document.getElementById('scenarioDesc');
        
        if(marketDropPct < 10) {
            titleEl.innerHTML = "ğŸŸ¢ å¸‚å ´ç‹€æ³ï¼šæ­£å¸¸æ³¢å‹•";
            descEl.innerHTML = "æ—¥å¸¸çš„å¸‚å ´æ¼²è·Œï¼Œå°æ‚¨çš„è³‡ç”¢æ·¨å€¼å½±éŸ¿å¾®ä¹å…¶å¾®ã€‚";
            titleEl.style.color = "var(--success)";
        } else if(marketDropPct < 20) {
            titleEl.innerHTML = "ğŸŸ¢ å¸‚å ´ç‹€æ³ï¼šä¿®æ­£æœŸ (-10% ~ -20%)";
            descEl.innerHTML = "è‚¡å¸‚é€²å…¥ä¿®æ­£ï¼Œä½†å—æƒ æ–¼æ‚¨çš„å‚µåˆ¸éƒ¨ä½ï¼Œæ•´é«”è³‡ç”¢è·Œå¹…æœ‰é™ã€‚";
            titleEl.style.color = "#2c3e50";
        } else if(marketDropPct < 30) {
            titleEl.innerHTML = "ğŸŸ¡ å¸‚å ´ç‹€æ³ï¼šç†Šå¸‚ä¾†è‡¨ (-20% ~ -30%)";
            descEl.innerHTML = "é¡ä¼¼ 2022 å¹´æˆ–æ­å‚µå±æ©Ÿã€‚æ‚¨çš„è³‡ç”¢æ·¨å€¼ç¸®æ°´ï¼Œä½†è·é›¢æ–·é ­é–€æª»ä»éå¸¸é™é ã€‚";
            titleEl.style.color = "var(--warning)";
        } else if(marketDropPct < 45) {
            titleEl.innerHTML = "ğŸŸ  å¸‚å ´ç‹€æ³ï¼šé‡å¤§è‚¡ç½ (COVID-19 ç­‰ç´š)";
            descEl.innerHTML = "é¡ä¼¼ 2020 å¹´ç–«æƒ…çˆ†ç™¼ã€‚å…¨çƒè‚¡å¸‚ææ…Œï¼Œä½†æ‚¨çš„ã€Œä¿å–® Eã€èˆ‡ã€Œä½æ§“æ¡¿ ETFã€æä¾›äº†å¼·å¤§çš„å®‰å…¨ç¶²ã€‚";
            titleEl.style.color = "#e67e22";
        } else {
            titleEl.innerHTML = "ğŸ”´ å¸‚å ´ç‹€æ³ï¼šé‡‘èæµ·å˜¯ (-50% ä»¥ä¸Š)";
            descEl.innerHTML = "é¡ä¼¼ 2008 å¹´é›·æ›¼å…„å¼Ÿå€’é–‰ã€‚é€™æ˜¯æ¥µé™å£“åŠ›æ¸¬è©¦ï¼Œè«‹é—œæ³¨ä¸‹æ–¹å€‹åˆ¥è³‡ç”¢çš„é»ƒ/ç´…ç‡ˆè­¦ç¤ºã€‚";
            titleEl.style.color = "var(--danger)";
        }

        const grid = document.getElementById('cardGrid');
        grid.innerHTML = '';

        assets.forEach(item => {
            // Beta è¨­å®šï¼šå¹³è¡¡å‹ 0.6, ETF 0.55, å„²è“„éšª 0
            let beta = (item.type === 1) ? 0.6 : (item.type === 3) ? 0.55 : 0;
            const itemDropPct = marketDropPct * beta;
            const currentVal = item.val * (1 - (itemDropPct / 100));

            let riskVal = 0; 
            let status = 'safe';
            let statusText = 'å®‰å…¨';
            let barColor = 'var(--success)';
            let barWidth = 0;
            let displayRisk = '';

            // è¨ˆç®—é¢¨éšª
            if (item.type === 1 || item.type === 2) {
                // ä¿å–® (LTV)
                riskVal = (item.loan / currentVal) * 100;
                displayRisk = `å€Ÿæ¬¾æ¯” ${riskVal.toFixed(1)}%`;
                
                if (riskVal >= item.limit2) {
                    status = 'danger'; statusText = 'æ–·é ­'; barColor = 'var(--danger)';
                } else if (riskVal >= item.limit1) {
                    status = 'warn'; statusText = 'éœ€è£œç¹³'; barColor = 'var(--warning)';
                }
                barWidth = Math.min(riskVal, 100);
            } else {
                // ETF (ç¶­æŒç‡)
                riskVal = (currentVal / item.loan) * 100;
                displayRisk = `ç¶­æŒç‡ ${riskVal.toFixed(0)}%`;
                
                if (riskVal <= item.limit2) {
                    status = 'danger'; statusText = 'æ–·é ­'; barColor = 'var(--danger)';
                } else if (riskVal <= item.limit1) {
                    status = 'warn'; statusText = 'è¿½ç¹³'; barColor = 'var(--warning)';
                }
                // ç¶­æŒç‡è¦–è¦ºåŒ–ï¼šæ»¿æ ¼ç‚ºå®‰å…¨ (300%)ï¼Œä½ç‚ºå±éšª
                // ç‚ºäº†è¦–è¦ºä¸€è‡´ï¼Œæˆ‘å€‘åè½‰é¡¯ç¤ºé‚è¼¯ï¼šæ¢è¶Šé•·è¶Šå®‰å…¨
                barWidth = Math.min((riskVal / 300) * 100, 100); 
            }

            const html = `
            <div class="card ${status}">
                <div class="card-top">
                    <span class="asset-name">${item.name}</span>
                    <span class="tag" style="background:${barColor}">${statusText}</span>
                </div>
                <div class="data-row">
                    <span>åŸå§‹ç¾å€¼</span>
                    <span class="num">${item.val} è¬</span>
                </div>
                <div class="data-row">
                    <span>æ¨¡æ“¬ç¾å€¼ (-${itemDropPct.toFixed(1)}%)</span>
                    <span class="num val-sim">${currentVal.toFixed(1)} è¬</span>
                </div>
                <div class="data-row">
                    <span>å€Ÿæ¬¾é‡‘é¡</span>
                    <span class="num">${item.loan} è¬</span>
                </div>
                
                <div class="bar-container">
                    <div class="bar-fill" style="width: ${barWidth}%; background: ${barColor};"></div>
                </div>
                <div class="bar-info">
                    <span>${displayRisk}</span>
                    <span>${item.type === 3 ? 'ç¶­æŒç‡ > 130% å®‰å…¨' : 'å€Ÿæ¬¾æ¯” < 80% å®‰å…¨'}</span>
                </div>
            </div>
            `;
            grid.innerHTML += html;
        });
    }

    // åˆå§‹åŒ–
    updateSimulation();
</script>

</body>
</html>
